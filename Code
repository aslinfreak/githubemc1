Referral Bonus, Joining Bonus, and Notice Pay Buyout Components

Under the PFSS Admin â€“ Reversal option, when uploading input for certain associates with a single entry and amount, the system generates two entries for the same associate ID and amount, but with different project codes. A sample has already been shared for reference.

Iam facing the above issue,Is this is the correct query to solve that

--Notice Pay Buy out-payout,Referral Bonus-payout,Joining Bonus-payout
if(@componentGroupId in (1,2,3))
BEGIN  

DECLARE @COMPONENTID INT

SELECT @COMPONENTID=PK_ComponentId  FROM COMPONENTMASTER WITH(NOLOCK)
WHERE FK_ComponentGroupID=@componentGroupId AND RowStatus=1 AND IsActive=1
    
          
 IF(ISNULL(@AssociateId,'')='')        
  BEGIN         
     SELECT PK_ReversalId,PRR.AssociateID,ISNULL(LTRIM(RTRIM(Associate_FirstName)),'')+' '+ISNULL(LTRIM(RTRIM(
	 Associate_LastName)),'') AS AssociateName,  
     ISNULL(Amount,'') AS Amount,ISNULL(InputRemarks,'') AS Remarks FROM PR.Reversal PRR WITH(NOLOCK)  
     INNER JOIN  CENTRALREPOSITORY.DBO.VW_CENTRALREPOSITORY_ASSOCIATE_DETAILS CAD WITH(NOLOCK) 
	 ON CAD.Associate_ID=PRR.AssociateID 
     WHERE PRR.FK_ComponentID=@COMPONENTID AND PRR.ROWSTATUS=1 AND PRR.Status=1 
	 ORDER BY CreatedDate DESC,ModifiedDate DESC        
  END        
 ELSE        
  BEGIN        
     SELECT PK_ReversalId,PRR.AssociateID,ISNULL(LTRIM(RTRIM(Associate_FirstName)),'')+' '+ISNULL(LTRIM(
	 RTRIM(Associate_LastName)),'') AS AssociateName,  
     ISNULL(Amount,'') AS Amount,ISNULL(InputRemarks,'') AS Remarks FROM PR.Reversal PRR WITH(NOLOCK)  
     INNER JOIN  CENTRALREPOSITORY.DBO.VW_CENTRALREPOSITORY_ASSOCIATE_DETAILS CAD WITH(NOLOCK) ON 
	 CAD.Associate_ID=PRR.AssociateID 
     WHERE PRR.FK_ComponentID=@COMPONENTID AND PRR.AssociateID=@AssociateId AND PRR.ROWSTATUS=1 AND PRR.Status=1  
     ORDER BY CreatedDate DESC,ModifiedDate DESC      
  END 
  
  END
