INSERT INTO PR.Reversal(FK_ComponentID, FK_MyPayComponentID, AssociateID, Amount, Status,
InputRemarks, CreatedBy, CreatedDate,RowStatus,ProjectID)  
SELECT DISTINCT SR.Fk_componentGroupID,CM.FK_MypayComponentId,SR.ASSOCIATEID,SR.Amount,1,
SR.InputRemarks,SR.CreatedBy, GETDATE(),1,JB.ProjectID  
FROM STG.Reversal SR WITH(NOLOCK)  
INNER JOIN ComponentMaster CM WITH(NOLOCK) ON CM.PK_ComponentId=SR.Fk_componentGroupID AND CM.RowStatus=1  
INNER JOIN PR.JoiningBonus JB WITH (NOLOCK) ON JB.AssociateID=SR.AssociateID AND JB.Status=5  
WHERE SR.RowStatus=1 AND SR.Fk_componentGroupID=3 

 INSERT INTO PR.JoiningBonus(AssociateID,DOJ,BGstatus,Grade,Amount,Status,ProjectId,
	RecruitmentType,InputRemarks,SpecialCaseReason,CompanyID,SetID,CreatedBy,CreatedDate,RowStatus,NoInstallments, RetentionPeriod)
	SELECT AssociateID,DateOfJoining,BGstatus,Grade,Amount,1,ProjectId,TT.RecruitmentType,
	InputRemarks,MC.CCodeId,COMPANY,BU,TT.CreatedBy,GETDATE(),1 ,
	 TT.NoInstallments,
	 	(Case When  (TT.RecruitmentType in (1,3) and TT.NoInstallments in (1,2))  then 1 
		When (TT.RecruitmentType in (1,3) and TT.NoInstallments in (4,5))   then 2 
		When TT.RecruitmentType=2 Then TT.RetentionPeriod
		else TT.RetentionPeriod end)	
	FROM #TEMP3 TT 
	LEFT OUTER JOIN MasterCodes MC WITH(NOLOCK) ON CParentRef=2
	AND UPPER(CDescription)=UPPER(LTRIM(RTRIM(TT.SpecialCaseReason))) AND RowStatus=1 
	AND CUserDefined1=3	WHERE EXPREMARKS=''  
