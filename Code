This is FileUpload.aspx.cs
    #region Upload Button Click

    /// <summary>
    /// 290050: Uploading the file to SAN and add an entry in DB with isProcessed=0
    /// </summary> 
    /// <param name="sender">sender object</param>
    /// <param name="e">EventArgs e</param>
    protected void BtnUpload_Click(object sender, EventArgs e)
    {
        ErrorLogger loggerECM = new ErrorLogger();
        loggerECM.LogErrorECM("Upload - FileUpload - BtnUpload_Click", "Country " + 1 + "Role " + this.RoleID + "ComponentGroupID "
                   + 0 + "ComponentID " + this.componentId + "ProjectID " + 0, this.userId, "ECM Upload Triggered");

        try
        {
            if (this.filUploadIcon.HasFile)
            {
                string fileName = EncodeHelper.HtmlEncode(Path.GetFileName(this.filUploadIcon.FileName));
                string strFileName = fileName.Replace("'", string.Empty).Replace(@"\", string.Empty);
                string strFileType = System.IO.Path.GetExtension(strFileName).ToString().ToLower();
               
                if ((strFileType.ToUpper() == ".MSG" || strFileType.ToUpper() == ".ZIP")
                    && string.IsNullOrEmpty(this.componentId))
                {
                    string[] strfileTypes = new string[] { ".msg", ".zip" };
                    string[] result = checkFileUpload(strfileTypes, 0);

                    this.fullpath = result[0].ToString();

                    if (result[1] == "")
                    {
                        this.filUploadIcon.PostedFile.SaveAs(EncodeHelper.HtmlEncode(this.fullpath));
                        ////string fileUploadId = this.UploadFiletoSAN(this.fullpath, strFileType, strFileName);
                        string fileUploadId = this.UploadFiletoECM(this.fullpath, strFileType, strFileName);
                        this.textFileName.Value = fileUploadId;
                    }
                    else
                    {
                        throw new SystemException(result[1]);
                    }
                    
                    if (this.hdnframeID.Value.ToString() == "frame")
                    {
                        string script =
     "<script type='text/javascript'>parent.$(parent.document).trigger('eventhandler');</script>";
                        Page.ClientScript.RegisterStartupScript(this.GetType(), "onload", script);
                    }
                    else if (this.hdnframeID.Value.ToString() == "frameforhide")
                    {
                        string script =
     "<script type='text/javascript'>parent.$(parent.document).trigger('eventhandlerhide');</script>";
                        Page.ClientScript.RegisterStartupScript(this.GetType(), "onload", script);
                    }
                    else if (this.hdnframeID.Value.ToString() == "frame2")
                    {
                        string script =
       "<script type='text/javascript'>parent.$(parent.document).trigger('eventhandler2');</script>";
                        Page.ClientScript.RegisterStartupScript(this.GetType(), "onload", script);
                    }
                    else if (this.hdnframeID.Value.ToString() == "frame3")
                    {
                        string script =
        "<script type='text/javascript'>parent.$(parent.document).trigger('eventhandler3');</script>";
                        Page.ClientScript.RegisterStartupScript(this.GetType(), "onload", script);
                    }            
                    else if (this.hdnframeID.Value.ToString() == "frame1")
                    {
                        string script =
      "<script type='text/javascript'>parent.$(parent.document).trigger('eventhandler1');</script>";
                        Page.ClientScript.RegisterStartupScript(this.GetType(), "onload", script);
                    }
                    else if (this.hdnframeID.Value.ToString() == "frame4")
                    {
                        string script =
"<script type='text/javascript'>parent.$(parent.document).trigger('eventhandler4');</script>";
                        Page.ClientScript.RegisterStartupScript(this.GetType(), "onload", script);
                    }
                    else if (this.hdnframeID.Value.ToString() == "frame5")
                    {
                        string script =
   "<script type='text/javascript'>parent.$(parent.document).trigger('eventhandler5');</script>";
                        Page.ClientScript.RegisterStartupScript(this.GetType(), "onload", script);
                    }
                    else if (this.hdnframeID.Value.ToString() == "frame6")
                    {
                        string script =
         "<script type='text/javascript'>parent.$(parent.document).trigger('eventhandler6');</script>";
                        Page.ClientScript.RegisterStartupScript(this.GetType(), "onload", script);
                    }
                    else if (this.hdnframeID.Value.ToString() == "frame7")
                    {
                        string script =
         "<script type='text/javascript'>parent.$(parent.document).trigger('eventhandler7');</script>";
                        Page.ClientScript.RegisterStartupScript(this.GetType(), "onload", script);
                    }
                    else if (this.hdnframeID.Value.ToString() == "frame8")
                    {
                        string script =
         "<script type='text/javascript'>parent.$(parent.document).trigger('eventhandler8');</script>";
                        Page.ClientScript.RegisterStartupScript(this.GetType(), "onload", script);
                    }
                    else if (this.hdnframeID.Value.ToString() == "frame9")
                    {
                        string script =
         "<script type='text/javascript'>parent.$(parent.document).trigger('eventhandlerTRT');</script>";
                        Page.ClientScript.RegisterStartupScript(this.GetType(), "onload", script);
                    }


                    this.hdnframeID.Value = string.Empty;
                }
                else if ((strFileType.ToUpper() == ".MSG" || strFileType.ToUpper() == ".DOC"
                     || strFileType.ToUpper() == ".DOCX" || strFileType.ToUpper() == ".XLS"
                     || strFileType.ToUpper() == ".XLSX" || strFileType.ToUpper() == ".ZIP"
                     || strFileType.ToUpper() == ".NSF" || strFileType.ToUpper() == ".GIF"
                     || strFileType.ToUpper() == ".PNG" || strFileType.ToUpper() == ".PDF"
                     || strFileType.ToUpper() == ".JPG" || strFileType.ToUpper() == ".JPEG")
                 && (!string.IsNullOrEmpty(this.componentId)))
                {
                    string[] strfileTypes = new string[] { ".msg", ".zip" };
                    string[] result = checkFileUpload(strfileTypes, 0);

                    this.fullpath = result[0].ToString();

                    if (result[1] == "")
                    {
                        this.filUploadIcon.PostedFile.SaveAs(EncodeHelper.HtmlEncode(this.fullpath));
                        ////string fileUploadId = this.UploadFiletoSAN(this.fullpath, strFileType, strFileName);
                        string fileUploadId = this.UploadFiletoECM(this.fullpath, strFileType, strFileName);
                        this.textFileName.Value = fileUploadId;
                    }
                    else
                    {
                        throw new SystemException(result[1]);
                    }

                    if (this.hdnframeID.Value.ToString() == "frameMBInvoice")
                    {
                        string script =
         "<script type='text/javascript'>parent.$(parent.document).trigger('eventhandlerMBInvoice');</script>";
                        Page.ClientScript.RegisterStartupScript(this.GetType(), "onload", script);
                    }
                }
                else
                {
                    string script =
 "<script type='text/javascript'>parent.$(parent.document).trigger('popupprogresseventshow');</script>";
                    Page.ClientScript.RegisterStartupScript(this.GetType(), "onload", script);

                    this.hdnframeID.Value = string.Empty;
                }
            }
        }
        catch (SystemException ex)
        {
            ErrorLogger logger = new ErrorLogger();
            logger.LogError(ex);
            if (!(ex.Message.Equals("Uploaded file is empty") ||
          ex.Message.Equals("Number of columns in uploaded file does not match") ||
         ex.Message.Equals("Please fill the mandatory columns")))
            {
                SendMailer.SendErrorMaileronFailure("Upload data", ex);
            }

            string script = string.Concat("<script type='text/javascript'>Message('", ex.Message, "');", "</script>");
            Page.ClientScript.RegisterStartupScript(this.GetType(), "onload", script);
        }
    }

    #endregion Upload Button Click
