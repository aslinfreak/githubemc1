if(@componentid=35)  
BEGIN  
--------------Insert data--------------------  
  INSERT INTO #RoleTable(Fk_RoleID)  
  select CRM.FK_RoleID from Userrolemapping URM with (nolock)  
  inner join ComponentRoleMapping CRM with (nolock)   
  on URM.FK_ComponentRoleID=CRM.PK_ComponentRoleID and URM.RowStatus=1  
  INNER jOIN ComponentMaster CM with (nolock)   
  on CM.PK_ComponentId=@COMPONENTID and CRM.RowStatus=1   
  INNER JOIN COMPONENTCOUNTRYMAPPING CCM WITH(NOLOCK)   
  ON CCM.PK_COMPONENTCOUNTRYMAPPINGID=CRM.FK_COMPONENTCOUNTRYMAPPINGID  
  where associateid=@LOGINID and CM.RowStatus=1   
  
select @RolePriority=0 from #RoleTable where Fk_RoleID not in (8,3) and Fk_Roleid in (1,7,9)   
select @RolePriority =1 from #RoleTable where Fk_RoleID in (8,3)   
Declare @Startmonth int,@EndMonth int  
Select @Startmonth= CASE WHEN  @QUARTER=2 then 1   
when @QUARTER=3 then @QUARTER+1 when @QUARTER=4 then @QUARTER+3   
when @QUARTER=5 then @QUARTER+5 end  
Select @EndMonth=@Startmonth+2  
  
/*check Quarter 1*/  
if(@QUARTER =1)  
BEGIN  
 SElect @Startmonth= CASE WHEN @QUARTER=1 then @QUARTER end  
 Select @EndMonth=12  
END  
  if(@RolePriority=0)  
  BEGIN  
  SELECT PCBA.AssociateID,ISNULL(LTRIM(RTRIM(AD.Associate_FirstName)),'')+' '  
  +ISNULL(LTRIM(RTRIM(AD.Associate_LastName)),'') AS AssociateName,  
  Level,isnull(BUProposedCBAAmount,'') BUProposedCBAAmount,  
  isnull(PreviousCBAAmountProposed,'') PreviousCBAAmountProposed,isnull(Amount,'') FinalCBAAmount,  
  isnull(MC.CDescription,'') SpecialCaseReason,isnull(PCBA.InputRemarks,'') InputRemarks,   
  CASE when Status=3 then 'Rejected' else 'Deleted' end Status,  
  PCBA.Createdby TalentManagerID,  
  ISNULL(LTRIM(RTRIM(UD.Associate_FirstName)),'')+' '  
  +ISNULL(LTRIM(RTRIM(UD.Associate_LastName)),'') AS TalentManagerName,  
  PCBA.CreatedDate UploadedDate,(CASE WHEN PCBA.Status IN (8,3) THEN 'Rejected by PFSS admin'
	 ELSE CONVERT(VARCHAR,PCBA.ModifiedBy) END) AS RejectedBy,PCBA.ModifiedDate 'Rejected\Deleteddate'  
  FROM PR.CognizantBusinessAllowance PCBA WITH (NOLOCK)  
  LEFT OUTER  JOIN CENTRALREPOSITORY.DBO.vw_CentralRepository_Associate_Details AD WITH(NOLOCK)  
  ON AD.Associate_ID=PCBA.AssociateID   
  LEFT OUTER JOIN mastercodes MC WITH(NOLOCK) on MC.CParentref=2 and MC.CUserdefined1=6   
  and MC.Rowstatus=1 and MC.CCodeid=PCBA.SpecialCaseReason  
  LEFT Outer Join MasterCodes MC_A WITH(NOLOCK) on MC_A.CParentRef=3 and PCBA.Status=MC_A.CCodeId   
  and MC_A.RowStatus=1 and MC_A.Cuserdefined1='PR'  
  LEFT OUTER  JOIN CENTRALREPOSITORY.DBO.vw_CentralRepository_Associate_Details UD WITH(NOLOCK)   
  ON UD.Associate_ID=PCBA.CreatedBy   
  WHERE PCBA.CreatedBy=@LoginID and (PCBA.Status =3 or PCBA.RowStatus=0)   
  AND (month(PCBA.createddate) between @Startmonth and @EndMonth) AND year(PCBA.CreatedDate)=@year    
  
  END  
