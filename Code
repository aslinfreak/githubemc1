        public void DownloadFileFromECMForIT(DataSet dsfiles, string fileUploadId, string loginid,
            int componentGrpId,string projID, string advisedBy,int countryID)
        {
            try
            {
                if (dsfiles.Tables[0].Rows.Count > 0)
                {
                    try
                    {
                        UtilityBAL objUtilityBAL = new UtilityBAL();
                        string fileName = String.Empty;
                        /* Convert Excel to DataTable */
                        DataTable dtexcel = this.ConvertExcelITtoDataTable(fileName, loginid, fileUploadId, componentGrpId);
                        if (dtexcel.Rows.Count >= 1)
                        {
                            if (componentGrpId == 4)
                            {
                                ComponentDetails objCompDetails = new ComponentDetails()
                                {
                                    ComponentGroupId = componentGrpId,
                                    FileUploadId = fileUploadId,
                                    ProjectID = projID
                                };

                                /*Move files from SAN to DB for Processing*/
                                this.MoveFilestoDB(dsfiles, componentGrpId, projID, advisedBy, dtexcel);
                                this.ValidateSAStagingData(objCompDetails);
                            }
                            else if (componentGrpId == 12 || componentGrpId == 98)
                            {
                                ComponentDetails objCompDetails = new ComponentDetails()
                                {
                                    ComponentGroupId = componentGrpId,
                                    FileUploadId = fileUploadId,
                                    ProjectID = projID,
                                };

                                /*Move files from ECM to DB for Processing*/
                                this.MoveITSAFilestoDB(dsfiles, componentGrpId, projID, advisedBy, dtexcel);
                                this.ValidateSAStagingData(objCompDetails);
                            }
                            this.SendMailtoUploader(fileUploadId, 0, countryID);
                        }
                    }
                    catch (ArgumentException ex)
                    {
                        ErrorLogger objLogger = new ErrorLogger();
                        objLogger.LogError(ex);
                        this.objReminderMail.SendErrorMaileronFailure("DownloadFileFromECMForIT", ex);
                    }
                    catch (FormatException ex)
                    {
                        ErrorLogger objLogger = new ErrorLogger();
                        objLogger.LogError(ex);
                        this.objReminderMail.SendErrorMaileronFailure("DownloadFileFromECMForIT", ex);
                    }
                    catch (OverflowException ex)
                    {
                        ErrorLogger objLogger = new ErrorLogger();
                        objLogger.LogError(ex);
                        this.objReminderMail.SendErrorMaileronFailure("DownloadFileFromECMForIT", ex);
                    }
                    catch (SqlException ex)
                    {
                        ErrorLogger objLogger = new ErrorLogger();
                        objLogger.LogError(ex);
                        ////objFileUploadDC.LoginID = loginId;

                        int status = 6; int errorFlag = 2;
                        this.SenderrorMailtoUploader(loginid, fileUploadId, status, errorFlag);
                    }
                }
            }
            catch (ArgumentException ex)
            {
                ErrorLogger objLogger = new ErrorLogger();
                objLogger.LogError(ex);
                //throw ex;
            }
        }
        #endregion DownloadFileFromSANForIT
