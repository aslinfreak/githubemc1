This is my usp_GetUploaderValidRecord_CE(SP). In my application the data is processed but it can't reflect in the grid.For that I run the sp manually but it shows
the columns only there is no record in that.Is this is the correct sp and Help me to fix that

Declare
@COMPONENTGROUPID INT=18,
@SearchData VARCHAR(100) = null,
@DdlData VARCHAR(100) = null,
@SearchData2 VARCHAR(100) = null,
@DdlData2 VARCHAR(100) = null,
@SearchData3 VARCHAR(100) = null,
@DdlData3 VARCHAR(100) = null,
@SearchData4 VARCHAR(100) = null,
@DdlData4 VARCHAR(100) = null, 
@PageNum INT = 1, 
@IDisplayLength INT = 250, 
@OrderBy VARCHAR(30) = '',
@SortOrder INT = 1,
@GetPages INT = 0,
@ProjectId VARCHAR(30)='',
@RoleID int=0,
@CountryID int=0,
@LoginID INT='2298944'


ELSE IF(@RoleID in (1,19))
	BEGIN	
		insert into #ASSOCIATE(ASSOCIATEID)
		select @LoginID
		
		--/*Check Searchdata*/
		IF(ISNULL(@searchData,'')='' and ISNULL(@searchData2,'')='')
		BEGIN
		SELECT distinct SF.PK_CESchoolFeesID,SF.AssociateID,ISNULL(LTRIM(RTRIM(AD.Associate_FirstName)),'')
		+' '+ISNULL(LTRIM(RTRIM(AD.Associate_LastName)),'') AS AssociateName,			
		(case when ChildType = 1 then 'Child1' when ChildType = 2 then 'Child2' else null end) as ChildType,
		StartDate,EndDate,isnull(SF.Amount,'')Amount,
		isnull(MC_B.Cdescription,'') as NumberOfInstallment,MC.Cdescription as FrequencyType,
		(Case when frequencyType= 1 then MM.MonthName when FrequencyType= 2 then MC_A.CDescription 
		when FrequencyType= 3 then SF.FrequencySelection else null end) as FrequencySelection,
		SF.Year,ISNULL(SF.RejectionReason,'') AS RejectionReason,ST.CDescription Status,
		SF.InvoiceAttachment AS InvoiceAttachment,
		PayoutType
		INTO #TEMPSchool4
		FROM PR.CESchoolFees SF WITH (NOLOCK)
		inner JOIN CENTRALREPOSITORY.DBO.vw_CentralRepository_Associate_Details AD WITH(NOLOCK)
		ON AD.Associate_ID=SF.AssociateID 
		INNER JOIN #ASSOCIATE A WITH(NOLOCK) ON A.ASSOCIATEID in (SF.Createdby,SF.ASSOCIATEID)
		INNER JOIN MasterCodes ST WITH (NOLOCK) on ST.CParentRef=3 and SF.Status=ST.CCodeId 
		and ST.Cuserdefined1='PR' and SF.Rowstatus=1
		inner join Mastercodes MC with(nolock) on MC.Cparentref=40 and MC.Ccodeid =@COMPONENTGROUPID 
		and MC.Remarks=@CountryID and MC.rowstatus=1 and SF.FrequencyType=MC.CUserDefined1
		and MC.CUserDefined2 <> 58
		left outer join Mastercodes MC_A with(nolock) on MC_A.Cparentref=40 and MC_A.Ccodeid =@COMPONENTGROUPID 
		and MC_A.Cuserdefined5=1 and MC_A.rowstatus=1 and SF.FrequencySelection=MC_A.CUserdefined1
		left outer join MonthMaster MM with(nolock) on MM.MonthID=SF.FrequencySelection
		Left Outer join #Year YY with(nolock) on YY.YearId= SF.FrequencySelection
	    left outer join Mastercodes MC_B with(nolock) on MC_B.Cparentref=41 and MC_B.Ccodeid =@COMPONENTGROUPID
		and MC_B.Cuserdefined5=1 and MC_B.rowstatus=1 and SF.NumberOfInstallment=MC_B.CUserdefined1
		WHERE SF.Status IN (SELECT data FROM DBO.FUNCTION_STRING_TO_TABLE(@STATUS,',')) 
		and SF.Fk_ComponentCountrymappingid=@ComponentCountryMappingId
		and SF.CreatedDate<=getdate()
		
		IF(@getPages=0)
		BEGIN
		--Sort by Ascending
			IF @sortOrder = 1
			BEGIN
			EXEC('SELECT Rowno,PK_CESchoolFeesID,AssociateID,AssociateName,Amount,StartDate,EndDate,
			ChildType,FrequencyType,FrequencySelection,Year,
			NumberOfInstallment,RejectionReason,Status,InvoiceAttachment,PayoutType FROM
			(SELECT ROW_NUMBER() OVER (ORDER BY '+@orderby+' ASC) AS [RowNo],* FROM #TEMPSchool4) t
			WHERE RowNo BETWEEN '+ @iDisplayStart1+' AND '+@iDisplayEnd1)
			END
			ELSE
			BEGIN
			EXEC('SELECT Rowno,PK_CESchoolFeesID,AssociateID,AssociateName,Amount,StartDate,EndDate,
			ChildType,FrequencyType,FrequencySelection,Year,
			NumberOfInstallment,RejectionReason,Status,InvoiceAttachment,PayoutType FROM
			(SELECT ROW_NUMBER() OVER (ORDER BY '+@orderby+' DESC) AS [RowNo],* FROM #TEMPSchool4) t
			WHERE RowNo BETWEEN '+ @iDisplayStart1+' AND '+@iDisplayEnd1)
			END
					
		END
		ELSE
		BEGIN
		--get total records
			SELECT @totrec1=count(1) FROM #TEMPSchool4
			IF (@totrec1%@iDisplayLength)=0
			SELECT (@totrec1/@iDisplayLength) AS Pages,@totrec1 AS Total
			ELSE
			SELECT (@totrec1/@iDisplayLength)+1 AS Pages,@totrec1 AS Total
			END
				--------Drop temp table ----------
		DROP TABLE #TEMPSchool4
		END

		--/*Check Searchdata*/
		ELSE IF(ISNULL(@searchData,'')<>'' and ISNULL(@searchData2,'')='')
		BEGIN
				SELECT distinct SF.PK_CESchoolFeesID,SF.AssociateID,ISNULL(LTRIM(RTRIM(AD.Associate_FirstName)),'')
				+' '+ISNULL(LTRIM(RTRIM(AD.Associate_LastName)),'') AS AssociateName,			
				(case when ChildType = 1 then 'Child1' when ChildType = 2 then 'Child2' else null end) as ChildType,
				StartDate,EndDate,isnull(SF.Amount,'')Amount,
				isnull(MC_B.Cdescription,'') as NumberOfInstallment,MC.Cdescription as FrequencyType,
				(Case when frequencyType= 1 then MM.MonthName when FrequencyType= 2 then MC_A.CDescription 
				when FrequencyType= 3 then SF.FrequencySelection else null end) as FrequencySelection,
				SF.Year,ISNULL(SF.RejectionReason,'') AS RejectionReason,ST.CDescription Status,
				SF.InvoiceAttachment AS InvoiceAttachment,
				PayoutType
				INTO #TEMPSchool5
				FROM PR.CESchoolFees SF WITH (NOLOCK)
			    inner JOIN CENTRALREPOSITORY.DBO.vw_CentralRepository_Associate_Details AD WITH(NOLOCK) 
				ON AD.Associate_ID=SF.AssociateID 
				INNER JOIN #ASSOCIATE A WITH(NOLOCK) ON A.ASSOCIATEID in (SF.Createdby,SF.ASSOCIATEID)
				INNER JOIN MasterCodes ST WITH (NOLOCK) on ST.CParentRef=3 and SF.Status=ST.CCodeId 
				and ST.Cuserdefined1='PR' and SF.Rowstatus=1
				inner join Mastercodes MC with(nolock) on MC.Cparentref=40 and MC.Ccodeid =@COMPONENTGROUPID 
				and MC.Remarks=@CountryID and MC.rowstatus=1 and SF.FrequencyType=MC.CUserDefined1  
				and MC.CUserDefined2 <> 58
				left outer join Mastercodes MC_A with(nolock) on MC_A.Cparentref=40 
				and MC_A.Ccodeid =@COMPONENTGROUPID and MC_A.Cuserdefined5=1 and MC_A.rowstatus=1 
				and SF.FrequencySelection=MC_A.CUserdefined1
				left outer join MonthMaster MM with(nolock) on MM.MonthID=SF.FrequencySelection
				Left Outer join #Year YY with(nolock) on YY.YearId= SF.FrequencySelection
				left outer join Mastercodes MC_B with(nolock) on MC_B.Cparentref=41 
				and MC_B.Ccodeid =@COMPONENTGROUPID and MC_B.Cuserdefined5=1 and MC_B.rowstatus=1 
				and SF.NumberOfInstallment=MC_B.CUserdefined1
				WHERE  SF.AssociateID LIKE LTRIM(RTRIM('%' + @searchData + '%')) and SF.Rowstatus=1 
				and SF.Status IN (SELECT data FROM DBO.FUNCTION_STRING_TO_TABLE(@STATUS,','))
				and SF.Fk_ComponentCountrymappingid=@ComponentCountryMappingId
				and SF.CreatedDate<=getdate()

				IF(@getPages=0)
				BEGIN
				--Sort by Ascending
				IF @sortOrder = 1
				BEGIN
				
					EXEC('SELECT Rowno,PK_CESchoolFeesID,AssociateID,AssociateName,Amount,StartDate,
					EndDate,ChildType,FrequencyType,FrequencySelection,Year,
					NumberOfInstallment,RejectionReason,Status,InvoiceAttachment,PayoutType FROM
					(SELECT ROW_NUMBER() OVER (ORDER BY '+@orderby+' ASC) AS [RowNo],* FROM #TEMPSchool5) t
					WHERE RowNo BETWEEN '+ @iDisplayStart1+' AND '+@iDisplayEnd1)
				END
				ELSE
				BEGIN
					EXEC('SELECT Rowno,PK_CESchoolFeesID,AssociateID,AssociateName,Amount,StartDate,
					EndDate,ChildType,FrequencyType,FrequencySelection,Year,
					NumberOfInstallment,RejectionReason,Status,InvoiceAttachment,PayoutType FROM
					(SELECT ROW_NUMBER() OVER (ORDER BY '+ @orderby+' DESC) AS [RowNo],* FROM #TEMPSchool5) t
					WHERE RowNo BETWEEN '+ @iDisplayStart1+' AND '+@iDisplayEnd1)
				END
				END
				ELSE
				BEGIN
				--get total records
				SELECT @totrec1=count(1) FROM #TEMPSchool5
				IF (@totrec1%@iDisplayLength)=0
				SELECT (@totrec1/@iDisplayLength) AS Pages,@totrec1 AS Total
				ELSE
				SELECT (@totrec1/@iDisplayLength)+1 AS Pages,@totrec1 AS Total
				END
				--------Drop temp table ----------
				Drop table #TEMPSchool5
			END

			--/*Check Searchdata*/
		ELSE IF(ISNULL(@searchData,'')='' and ISNULL(@searchData2,'')<>'')
		BEGIN
	
				SELECT distinct SF.PK_CESchoolFeesID,SF.AssociateID,ISNULL(LTRIM(RTRIM(AD.Associate_FirstName)),'')
				+' '+ISNULL(LTRIM(RTRIM(AD.Associate_LastName)),'') AS AssociateName,			
				(case when ChildType = 1 then 'Child1' when ChildType = 2 then 'Child2' else null end) as ChildType,
				StartDate,EndDate,isnull(SF.Amount,'')Amount,
				isnull(MC_B.Cdescription,'') as NumberOfInstallment,MC.Cdescription as FrequencyType,
				(Case when frequencyType= 1 then MM.MonthName when FrequencyType= 2 then MC_A.CDescription
				when FrequencyType= 3 then SF.FrequencySelection else null end) as FrequencySelection,
				SF.Year,ISNULL(SF.RejectionReason,'') AS RejectionReason,ST.CDescription Status,
				SF.InvoiceAttachment AS InvoiceAttachment,
				PayoutType
				INTO #TEMPSchool6
				FROM PR.CESchoolFees SF WITH (NOLOCK)
			    inner JOIN CENTRALREPOSITORY.DBO.vw_CentralRepository_Associate_Details AD WITH(NOLOCK) 
				ON AD.Associate_ID=SF.AssociateID 
				INNER JOIN #ASSOCIATE A WITH(NOLOCK) ON A.ASSOCIATEID in (SF.Createdby,SF.ASSOCIATEID)
				INNER JOIN MasterCodes ST WITH (NOLOCK) on ST.CParentRef=3 and SF.Status=ST.CCodeId 
				and ST.Cuserdefined1='PR' and SF.Rowstatus=1
				inner join Mastercodes MC with(nolock) on MC.Cparentref=40 and MC.Ccodeid =@COMPONENTGROUPID 
				and MC.Remarks=@CountryID and MC.rowstatus=1 and SF.FrequencyType=MC.CUserDefined1  
				and MC.CUserDefined2 <> 58
				left outer join Mastercodes MC_A with(nolock) on MC_A.Cparentref=40
				and MC_A.Ccodeid =@COMPONENTGROUPID and MC_A.Cuserdefined5=1 and MC_A.rowstatus=1 
				and SF.FrequencySelection=MC_A.CUserdefined1
				left outer join MonthMaster MM with(nolock) on MM.MonthID=SF.FrequencySelection
				Left Outer join #Year YY with(nolock) on YY.YearId= SF.FrequencySelection
				left outer join Mastercodes MC_B with(nolock) on MC_B.Cparentref=41 
				and MC_B.Ccodeid =@COMPONENTGROUPID and MC_B.Cuserdefined5=1 and MC_B.rowstatus=1 
				and SF.NumberOfInstallment=MC_B.CUserdefined1
				WHERE   SF.CreatedBy LIKE LTRIM(RTRIM('%' + @searchData2 + '%')) and SF.Rowstatus=1 
				and SF.Status IN (SELECT data FROM DBO.FUNCTION_STRING_TO_TABLE(@STATUS,','))
				and SF.Fk_ComponentCountrymappingid=@ComponentCountryMappingId
				and SF.CreatedDate<=getdate()
				
				IF(@getPages=0)
				BEGIN
				--Sort by Ascending
				IF @sortOrder = 1
				BEGIN
				
					EXEC('SELECT Rowno,PK_CESchoolFeesID,AssociateID,AssociateName,Amount,StartDate,
					EndDate,ChildType,FrequencyType,FrequencySelection,Year,
					NumberOfInstallment,RejectionReason,Status,InvoiceAttachment,PayoutType FROM
					(SELECT ROW_NUMBER() OVER (ORDER BY '+@orderby+' ASC) AS [RowNo],* FROM #TEMPSchool6) t
					WHERE RowNo BETWEEN '+ @iDisplayStart1+' AND '+@iDisplayEnd1)
				END
				ELSE
				BEGIN
					EXEC('SELECT Rowno,PK_CESchoolFeesID,AssociateID,AssociateName,Amount,StartDate,
					EndDate,ChildType,FrequencyType,FrequencySelection,Year,
					NumberOfInstallment,RejectionReason,Status,InvoiceAttachment,PayoutType FROM
					(SELECT ROW_NUMBER() OVER (ORDER BY '+ @orderby+' DESC) AS [RowNo],* FROM #TEMPSchool6) t
					WHERE RowNo BETWEEN '+ @iDisplayStart1+' AND '+@iDisplayEnd1)
				END
				END
				ELSE
				BEGIN
				--get total records
				SELECT @totrec1=count(1) FROM #TEMPSchool6
				IF (@totrec1%@iDisplayLength)=0
				SELECT (@totrec1/@iDisplayLength) AS Pages,@totrec1 AS Total
				ELSE
				SELECT (@totrec1/@iDisplayLength)+1 AS Pages,@totrec1 AS Total
				END
				--------Drop temp table ----------
				Drop table #TEMPSchool6
		END
	END
END
