INNER JOIN PR.JoiningBonus REF WITH (NOLOCK) 
    ON REF.AssociateID = SR.AssociateID AND REF.Status = 5
LEFT JOIN PR.Reversal EXISTING WITH(NOLOCK)
    ON EXISTING.AssociateID = SR.AssociateID
    AND EXISTING.FK_ComponentID = SR.Fk_componentGroupID
    AND EXISTING.ProjectID = REF.ProjectID   -- Prevent duplicates
    AND EXISTING.RowStatus = 1
WHERE SR.RowStatus = 1
  AND SR.Fk_componentGroupID = 3
  AND EXISTING.PK_ReversalID IS NULL;  
