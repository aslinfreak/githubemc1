ELSE IF(@componentid in (50,51) AND @RoleID in (2,3))  
    BEGIN  
    SELECT DISTINCT PSTP.AssociateID,ISNULL(LTRIM(RTRIM(AD.Associate_FirstName)),'')+' '  
    +ISNULL(LTRIM(RTRIM(AD.Associate_LastName)),'') AS AssociateName,  
    PSTP.ProjectID,CM.ComponentName AS AllowanceType,STM.SHIFTTYPENAME AS ShiftType,  
    CONVERT(VARCHAR,PSTP.StartDate,101) AS StartDate,CONVERT(VARCHAR(5),PSTP.StartTime,108) AS StartTime,  
    CONVERT(VARCHAR(5),PSTP.EndTime,108) AS EndTime,CONVERT(VARCHAR,PSTP.EndDate,101) AS EndDate,  
    ISNULL(PSTP.HCMSchedule,'') AS HCMShift,  
       PSTP.TransportEligibility AS TransportEligibility,  
    isnull(SDA_OCA_Amount,0) as SDA_OCA_Amount1,  
    isnull(SDA_OCA_Amount2,0) as SDA_OCA_Amount2,  
    PSTP.Amount as TotalAmount,  
    ISNULL(PSTP.REJECTIONREASON,'') AS RejectReason,  
    (CASE WHEN PSTP.Status=3 AND PSTP.RowStatus=1 THEN 'Rejected' WHEN PSTP.RowStatus=0 THEN 'Deleted'   
    when Status=23 and PSTP.RowStatus=1 then 'Rejected by Home Manager'   
    when Status=17 and PSTP.RowStatus=1 then 'Rejected by Project Manager'   
    when Status=36 and PSTP.RowStatus=1 then 'Rejected by D+' END) AS Status,   
    ISNULL(PSTP.InputRemarks,'') AS Remarks,PSTP.Createdby UploadedBy,  
    ISNULL(LTRIM(RTRIM(UD.Associate_FirstName)),'')+' '  
    +ISNULL(LTRIM(RTRIM(UD.Associate_LastName)),'') AS UploaderName,  
    PSTP.CreatedDate UploadedDate, 'PFSS Admin' as RejectedBy,PSTP.ModifiedDate 'Rejected\Deleteddate',PSTP.NSADate AS ShiftStartDate  
    FROM PR.ITSHIFTALLOWANCE PSTP WITH(NOLOCK)  
    LEFT OUTER JOIN COMPONENTMASTER CM WITH(NOLOCK)   
    ON CM.PK_COMPONENTID=PSTP.FK_COMPONENTID AND CM.ROWSTATUS=1  
    LEFT OUTER JOIN SHIFTTYPEMASTER STM WITH(NOLOCK)  
    ON STM.PK_SHIFTTYPEID=PSTP.FK_SHIFTTYPEID AND STM.RowStatus=1  
    LEFT OUTER JOIN CENTRALREPOSITORY.DBO.vw_CentralRepository_Associate_Details AD WITH(NOLOCK)   
    ON AD.Associate_ID=CONVERT(CHAR,PSTP.AssociateID)  
    LEFT OUTER  JOIN CENTRALREPOSITORY.DBO.vw_CentralRepository_Associate_Details UD WITH(NOLOCK)  
    ON UD.Associate_ID=CONVERT(CHAR,PSTP.CreatedBy)  
    WHERE (PSTP.STATUS in(3,17,23,36) OR PSTP.RowStatus=0)   
    AND ((DATEPART(MM,PSTP.CreatedDate)=@Month AND DATEPART(YY,PSTP.CreatedDate)=@Year) OR   
    (DATEPART(MM,PSTP.ModifiedDate)=@Month AND DATEPART(YY,PSTP.ModifiedDate)=@Year))   
    AND CM.PK_componentid=@componentid  
    END  
    ELSE  
    BEGIN  
    SELECT DISTINCT PSTP.AssociateID,ISNULL(LTRIM(RTRIM(AD.Associate_FirstName)),'')+' '  
    +ISNULL(LTRIM(RTRIM(AD.Associate_LastName)),'') AS AssociateName,  
    PSTP.ProjectID,CM.ComponentName AS AllowanceType,STM.SHIFTTYPENAME AS ShiftType,  
    CONVERT(VARCHAR,PSTP.StartDate,101) AS StartDate,CONVERT(VARCHAR(5),PSTP.StartTime,108) AS StartTime,  
    CONVERT(VARCHAR(5),PSTP.EndTime,108) AS EndTime,CONVERT(VARCHAR,PSTP.EndDate,101) AS EndDate,  
    ISNULL(PSTP.HCMSchedule,'') AS HCMShift,  
       PSTP.TransportEligibility AS TransportEligibility,PSTP.Amount,  
    ISNULL(PSTP.REJECTIONREASON,'') AS RejectReason,  
    (CASE WHEN PSTP.Status=3 AND PSTP.RowStatus=1 THEN 'Rejected' WHEN PSTP.RowStatus=0 THEN 'Deleted'   
    when Status=23 and PSTP.RowStatus=1 then 'Rejected by Home Manager'   
    when Status=17 and PSTP.RowStatus=1 then 'Rejected by Project Manager'   
    when Status=36 and PSTP.RowStatus=1 then 'Rejected by D+' END) AS Status,   
    ISNULL(PSTP.InputRemarks,'') AS Remarks,PSTP.Createdby UploadedBy,  
    ISNULL(LTRIM(RTRIM(UD.Associate_FirstName)),'')+' '  
    +ISNULL(LTRIM(RTRIM(UD.Associate_LastName)),'') AS UploaderName,  
    PSTP.CreatedDate UploadedDate,'PFSS Admin' as RejectedBy,PSTP.ModifiedDate 'Rejected\Deleteddate',PSTP.NSADate AS ShiftStartDate  
    FROM PR.ITSHIFTALLOWANCE PSTP WITH(NOLOCK)  
    LEFT OUTER JOIN COMPONENTMASTER CM WITH(NOLOCK)   
    ON CM.PK_COMPONENTID=PSTP.FK_COMPONENTID AND CM.ROWSTATUS=1  
    LEFT OUTER JOIN SHIFTTYPEMASTER STM WITH(NOLOCK)  
    ON STM.PK_SHIFTTYPEID=PSTP.FK_SHIFTTYPEID AND STM.RowStatus=1  
    LEFT OUTER JOIN CENTRALREPOSITORY.DBO.vw_CentralRepository_Associate_Details AD WITH(NOLOCK)   
    ON AD.Associate_ID=CONVERT(CHAR,PSTP.AssociateID)  
    LEFT OUTER  JOIN CENTRALREPOSITORY.DBO.vw_CentralRepository_Associate_Details UD WITH(NOLOCK)  
    ON UD.Associate_ID=CONVERT(CHAR,PSTP.CreatedBy )  
    WHERE (PSTP.STATUS in(3,17,23,36) OR PSTP.RowStatus=0)   
    AND ((DATEPART(MM,PSTP.CreatedDate)=@Month AND DATEPART(YY,PSTP.CreatedDate)=@Year) OR   
    (DATEPART(MM,PSTP.ModifiedDate)=@Month AND DATEPART(YY,PSTP.ModifiedDate)=@Year))   
    AND CM.PK_componentid=@componentid  
    END  
    END  
